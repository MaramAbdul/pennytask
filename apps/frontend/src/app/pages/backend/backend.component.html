<div class="p-10 text-white">
    <h1 class="text-3xl font-bold mb-4">Backend Documentation (NestJS)</h1>
    <p class="mb-6">This document outlines the structure, authentication flow, and session management in our NestJS
        backend.</p>

    <!-- Technology Stack -->
    <h2 class="text-2xl font-semibold mt-6 mb-3">ğŸ› ï¸ Technology Stack</h2>
    <ul class="list-disc ml-6 space-y-2">
        <li>ğŸ”¹ <strong>Framework:</strong> NestJS (Node.js + TypeScript)</li>
        <li>ğŸ”¹ <strong>Database:</strong> (Specify: PostgreSQL / MongoDB)</li>
        <li>ğŸ”¹ <strong>Authentication:</strong> JWT (JSON Web Tokens) with 8-hour sessions</li>
        <li>ğŸ”¹ <strong>ORM:</strong>  Mongoose</li>
        <li>ğŸ”¹ <strong>Monorepo:</strong> Nx workspace</li>
        <li>ğŸ”¹ <strong>Frontend:</strong> Angular (Managed inside the same monorepo)</li>
    </ul>

    <!-- Project Structure -->
    <h2 class="text-2xl font-semibold mt-6 mb-3">ğŸ“‚ Project Structure</h2>
    <pre class="bg-gray-900 p-4 rounded-md text-sm">
/apps
â”‚â”€â”€ backend/                  # Backend NestJS Application
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/              # Main App Module
â”‚   â”‚   â”œâ”€â”€ auth/             # Authentication Module
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/          # Data Transfer Objects (DTOs)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ login.dto.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ signup.dto.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.controller.ts  # Handles auth API endpoints
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.module.ts      # Auth module setup
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.ts     # Authentication logic
â”‚   â”‚   â”‚   â”œâ”€â”€ jwt.strategy.ts     # JWT strategy for session handling
â”‚   â”‚   â”œâ”€â”€ config/          # Configuration files (e.g., database, env settings)
â”‚   â”‚   â”œâ”€â”€ models/          # Database Models (e.g., User model)
â”‚   â”‚   â”‚   â”œâ”€â”€ user.model.ts
â”‚   â”‚   â”œâ”€â”€ main.ts          # Main entry point for NestJS
â”‚   â”œâ”€â”€ .env                 # Environment variables (JWT secrets, database, etc.)
â”‚â”€â”€ frontend/                 # Angular Frontend (in the same monorepo)
    </pre>

    <!-- Authentication Flow -->
    <h2 class="text-2xl font-semibold mt-6 mb-3">ğŸ” Authentication Flow</h2>
    <p>We use JWT-based authentication with an 8-hour session expiration.</p>
    <ol class="list-decimal ml-6 space-y-2">
        <li>User sends credentials to <strong>POST /api/auth/login</strong>.</li>
        <li>Server validates user and issues a **JWT token** with an 8-hour expiry.</li>
        <li>User includes this token in **Authorization: Bearer [TOKEN]** header for every request.</li>
        <li>Backend validates the token using `jwt.strategy.ts`.</li>
        <li>Once the token expires, the user must **re-authenticate**.</li>
    </ol>

    <!-- API Endpoints -->
    <h2 class="text-2xl font-semibold mt-6 mb-3">ğŸ“¡ API Endpoints</h2>
    <table class="w-full border border-gray-700 text-sm">
        <thead class="bg-gray-900">
            <tr>
                <th class="p-2 border border-gray-700">Method</th>
                <th class="p-2 border border-gray-700">Endpoint</th>
                <th class="p-2 border border-gray-700">Description</th>
            </tr>
        </thead>
        <tbody>
            <tr class="bg-gray-800">
                <td class="p-2 border border-gray-700">POST</td>
                <td class="p-2 border border-gray-700">/api/auth/login</td>
                <td class="p-2 border border-gray-700">User login (returns JWT token)</td>
            </tr>
            <tr class="bg-gray-700">
                <td class="p-2 border border-gray-700">POST</td>
                <td class="p-2 border border-gray-700">/api/auth/register</td>
                <td class="p-2 border border-gray-700">User registration</td>
            </tr>
        </tbody>
    </table>

    <!-- Key File Descriptions -->
    <h2 class="text-2xl font-semibold mt-6 mb-3">ğŸ“œ Key Files</h2>
    <ul class="list-disc ml-6 space-y-2">
        <li><strong>auth.controller.ts:</strong> Handles login and register API requests.</li>
        <li><strong>auth.service.ts:</strong> Handles authentication logic, password hashing, token generation.</li>
        <li><strong>jwt.strategy.ts:</strong> Validates JWT tokens for secure requests.</li>
        <li><strong>dto/login.dto.ts & signup.dto.ts:</strong> Defines expected request body formats.</li>
        <li><strong>models/user.model.ts:</strong> Defines the user schema.</li>
        <li><strong>config/*.ts:</strong> Handles database and environment configurations.</li>
    </ul>

    <!-- Environment Configuration -->
    <h2 class="text-2xl font-semibold mt-6 mb-3">âš™ï¸ Environment Configuration</h2>
    <p>The `.env` file contains all the important configurations:</p>
    <pre class="bg-gray-900 p-4 rounded-md text-sm">
JWT_SECRET=jwt_secret
JWT_EXPIRATION=8h
DATABASE_URL=database_url
    </pre>

    <!-- Notes -->
    <h2 class="text-2xl font-semibold mt-6 mb-3">ğŸ“Œ Notes</h2>
    <ul class="list-disc ml-6 space-y-2">
        <li>The **JWT token expires after 8 hours**, requiring re-login.</li>
        <li>Use **Postman** or **cURL** for API testing.</li>
        <li>Ensure **.env** file is correctly configured with database & JWT secrets.</li>
    </ul>
</div>